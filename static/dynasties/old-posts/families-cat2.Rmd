---
title: "Families"
author: ""
date: "2020-02-07"
params:
  orig_date: "Original Publish Date: 21 July, 2020"
  update_date: !r paste("Updated on:", format(Sys.time(), '%d %B, %Y'))
output:
  html_document:
    theme: readable
    toc: TRUE
    toc_float: TRUE
    toc_depth: 5
    number_sections: TRUE
    fig_width: 6            
editor_options: 
  chunk_output_type: inline

---

---

### Document History

`r params$orig_date`

`r params$update_date`

---

```{r set up, warning=FALSE, include=FALSE, message= FALSE}

knitr::opts_chunk$set(cache = FALSE,echo = FALSE, message=FALSE, warning = FALSE,fig.width = 16/2, fig.height = 9/2)


library(tidyverse)
library(data.table)
library(knitr)
library(kableExtra)
library(scales)
library(gridExtra)
library(stargazer)
library(ggbump)
`%!in%` = Negate(`%in%`)

select <- dplyr::select
```

In this post we further analyse the families. We categorised them into two - declining and rising. We track down all the families started in 1970s till 2007. Then we assess their performance in the elections held after 2007. This includes 3 General elections and 2 Assembly elections. If they have one at least one election in these 5 elections we call them rising dynasties and rest of them as declining dynasties.

---

The follwoing table shows the difference the longevity of these two groups






```{r file config}
dyn <- read.csv("D:/cpr/UP/up-dynasties/dyn_other_data/dyn_all.csv")

dyn_ae_ge <- dyn %>% filter(election_type %in% c("AE", "GE") & family_id != "")




```





```{r}
## Industries

dyn_indus <- read.csv("D:/cpr/UP/up-dynasties/ae_ge_indus.csv")

dyn_indus <- dyn_indus %>% filter(ï..election_type %in% c("AE", "GE"))


# dyn_indus <- dyn_indus %>% mutate(indus_2 = ifelse(indus_2>0,indus_2,0), indus_3 = ifelse(indus_3>0,indus_2,0),indus_4 = ifelse(indus_4>0,indus_4,0)) %>% select(ï..election_type,year, pid, indus_2, indus_3, indus_4)

names(dyn_indus)[1] <- "election_type"


#
 dyn_indus <- dyn_indus %>% mutate(indus_2_c = ifelse(indus_2 >= 0,1,0),indus_3_c = ifelse(indus_3>0,1,0), indus_4_c = ifelse(indus_4 > 0,1,0), indus_count = indus_2_c+indus_3_c+ indus_4_c) %>% dplyr::select(-c(indus_2_c, indus_3_c, indus_4_c))
#

#dyn_indus$indus_2 <- replace_na(dyn_indus$indus_2 ,0)

dyn_indus <- dyn_indus %>% mutate(indus_rt_2 = case_when(indus_2 %in% c(NA, "") ~ 0, indus_2 %in% c(1,3,7,2,4,5)~ 1,
                                  TRUE~ 2))

dyn_indus <- dyn_indus %>% mutate(indus_rt_3 = case_when(indus_3 %in% c(NA, "",0) ~ 0, indus_3 %in% c(1,3,7,2,4,5)~ 1,
                                  TRUE~ 2))

dyn_indus <- dyn_indus %>% mutate(indus_rt_4 = case_when(indus_4 %in% c(NA, "",0) ~ 0, indus_4 %in% c(1,3,7,2,4,5)~ 1,
                                  TRUE~ 2))

dyn_indus$indus_rt_glue <- paste(dyn_indus$indus_rt_2, dyn_indus$indus_rt_3, dyn_indus$indus_rt_4, sep = "")


dyn_indus <- dyn_indus %>% mutate(indus_rt = case_when(indus_rt_glue %in% c("100","120","122","201", "210", "212", "221") ~.3,
                                                               indus_rt_glue %in% c("110","112","121", "211")~.6,
                                                               indus_rt_glue == "111" ~1,
                                                               TRUE ~ 0))

dyn_indus <- dyn_indus %>% mutate(indus_nrt = case_when(indus_rt_glue %in% c("020","102","112","120","121","200", "210", "211", "221") ~.3,
                                                               indus_rt_glue %in% c("122", "202","220")~.6,
                                                               indus_rt_glue == "222" ~1,
                                                               TRUE ~ 0))

dyn_indus <- dyn_indus %>% distinct(family_id, .keep_all = TRUE)%>% dplyr::select(family_id, indus_rt, indus_nrt,indus_count)

#
dyn_ae_ge <- merge(dyn_ae_ge, dyn_indus, by = "family_id", all.x = TRUE, allow.cartesian = TRUE)
## cabinet


cabinet <- read.csv("D:/cpr/UP/up-dynasties/dyn_other_data/up_cabinet_01.07.20.csv")

#glimpse(cabinet)

names(cabinet) <- tolower(names(cabinet))

names(cabinet) <- make.unique(names(cabinet))

cabinet <- cabinet %>% rename(year = election_year_1)





cabinet$rel_id_unique <- as.numeric(cabinet$rel_id_unique)

cabinet <- cabinet %>% filter(rel_id_unique >0 )

#cabinet %>% filter(is.na())


cabinet <- cabinet %>% mutate(pre_90 = case_when(dplyr::between(year, 1977,1990)~ 1,
                             TRUE ~0), post_90 =case_when(dplyr::between(year, 1990,2017)~ 1,
                             TRUE ~0) )


#table(cabinet$post_90)


dyn_cabinet <-  cabinet  %>% filter(year!= "" & family_id >0 & family_id != "UK") %>% group_by(family_id) %>%summarise(n_sc_minster = n(), minister_dur = sum(term_months, na.rm = TRUE), pre_90_n = sum(pre_90), post_90_n = sum(post_90))

dyn_cabinet$min_dur_yr <- round(dyn_cabinet$minister_dur/12,2)





dyn_ae_ge <- merge(dyn_ae_ge,dyn_cabinet, by ="family_id", all.x =TRUE )
```


```{r}
# tab <- dyn_ae_ge_fam %>% group_by(family_id) %>% arrange(year) %>%  filter(dyn_cum ==1 &min(year)) %>% distinct(family_id, .keep_all = TRUE) %>% group_by(year) %>% summarise(count = n()) %>% kable()
dyn_ae_ge <- dyn_ae_ge %>% mutate(decade = cut(year, breaks = c(1970,1980,1990,2000,2010,2020), labels = c(1970,1980,1990,2000,2010), include.lowest = TRUE))
dyn_ae_ge$decade <-  year(as.Date(ISOdate(dyn_ae_ge$decade, 1, 1)))


# 
 dyn_ae_ge<- dyn_ae_ge %>% group_by(family_id) %>% mutate( max_year = max(year)) 
# 
# 
# dyn_ae_ge$life_span <- dyn_ae_ge$max_year - dyn_ae_ge$

```

```{r}
## Involvemnt



# 
# inv <- read.csv("D:/cpr/UP/up-dynasties/ae_ge_lb_who_is_who.csv")
# 
# inv <- inv  %>% dplyr::select(family_id,association_inv,org_inv, poitical_inv )
# 
# dyn_ae_ge <- merge(dyn_ae_ge,inv, by ="family_id", allow.cartesian = TRUE, all.x =TRUE )

```




<!-- ## 2nd category -->

```{r}

## life span
dyn_ae_ge_fam <- dyn_ae_ge  %>% filter(dyn_tot_2 == 1)


fam_tab <- rbind(dyn_ae_ge_fam %>% group_by(family_id) %>% filter( dyn_cum_2==0 ) %>% slice(which.max(year))%>% select(year, family_id,dyn_cum_2),

dyn_ae_ge_fam %>% group_by(family_id) %>% filter(dyn_cum_2==1  ) %>% slice(which.min(year)) %>% select(year, family_id,dyn_cum_2 )) %>%pivot_wider(values_from = year, names_from= dyn_cum_2) 



fam_tab <- fam_tab %>% mutate(`0` = ifelse(is.na(`0`), `1`,`0`), diff = `1`-`0`)



dyn_ae_ge_fam <- inner_join(dyn_ae_ge_fam, fam_tab, by = "family_id")


dyn_ae_ge_fam$life_span <- dyn_ae_ge_fam$max_year - dyn_ae_ge_fam$`0`

```


```{r}
dyn_ae_ge_fam  <- dyn_ae_ge_fam %>% mutate(id = paste0(family_id, relative_id, rel_id_rep))

dyn_ae_ge_fam <- dyn_ae_ge_fam %>%group_by(family_id)%>% mutate(n_pre_08 = n_distinct(id[year<= 2007]), n_post_08 = n_distinct(id[year>2007]))





```




```{r}

dyn_ae_ge_fam <- dyn_ae_ge_fam %>% mutate(success_cat = case_when(n_pre_08 >=2 & n_post_08==0 ~"Declining",
                                                                  n_pre_08>=2 & n_post_08 >0 ~"Stable",
                                                                  n_pre_08 <=1 & n_post_08 >=1 ~"Rising",
                                             TRUE~"OTHERS"))







# dyn_ae_ge_fam <- dyn_ae_ge_fam  %>%
#    mutate(across(c("district_name"), ~ifelse(.=="", NA, as.character(.))))
# 
# dyn_ae_ge_fam$district_name <- replace_na(dyn_ae_ge_fam$district_name , "ZNA")

dyn_ae_ge_fam_uniq <- dyn_ae_ge_fam  %>% group_by(family_id)%>% arrange(election_id)%>% distinct(family_id, .keep_all = TRUE)


#table(dyn_ae_ge_fam_uniq$success_cat)


```


## Elite types{.tabset}

### Definitions


![](D:/cpr/UP/up-dynasties/dyn_other_data/def_2_elite.png)

<!-- Eventhough we have 300 families in total, in this analysis has come down to 189. This is because, we are tracking families which are active before 2007. Then we asses how they have performed in last one decade or so to asses their performance. Criteria to be successful is that they have won one or more elections after 2007. -->

### Break-up of elite categories

```{r}


dyn_ae_ge_fam_uniq %>% ungroup() %>%group_by(success_cat) %>% summarise(count = n()) %>% kable() %>% kable_styling(full_width = F)

```

### Life span

```{r}
dyn_ae_ge_fam_uniq %>%  group_by(success_cat) %>% summarise(mean(life_span)) %>% kable(caption = "Average life span", digits = 0, col.names = c("Success", "Life span")) %>% kable_styling(full_width = F)
```





---

This chart depicts how the life span of a family varies according to their caste.







---


### years to be a  family

```{r}


# dyn_ae_ge_fam %>% group_by(family_id) %>% filter( dyn_cum_2==0 ) %>% slice(which.max(year))%>% select(year, family_id,dyn_cum_2)


fam_tab <- rbind(dyn_ae_ge_fam %>% group_by(family_id) %>% filter( dyn_cum_2==0 ) %>% slice(which.max(year))%>% select(year, family_id,dyn_cum_2),

dyn_ae_ge_fam %>% group_by(family_id) %>% filter(dyn_cum_2==1  ) %>% slice(which.min(year)) %>% select(year, family_id,dyn_cum_2 )) %>%pivot_wider(values_from = year, names_from= dyn_cum_2) 




```



```{r}


fam_tab <- rbind(dyn_ae_ge_fam %>% group_by(family_id) %>% filter( dyn_cum_2==0 ) %>% slice(which.max(year))%>% select(year, family_id,dyn_cum_2),

dyn_ae_ge_fam %>% group_by(family_id) %>% filter(dyn_cum_2==1  ) %>% slice(which.min(year)) %>% select(year, family_id,dyn_cum_2 )) %>%pivot_wider(values_from = year, names_from= dyn_cum_2) 


# 
# fam_tab %>% mutate(entry = `0`==`1`) %>% group_by(entry) %>% tally()


# mean(fam_tab$diff)

fam_tab <- fam_tab %>% mutate(`0` = ifelse(is.na(`0`), `1`,`0`), diff = `1`-`0`)
# 
# fam_tab %>% filter(diff==0)

# fam_tab %>% mutate(lag_group = cut(breaks= c()))


medx <- median(fam_tab$diff)
meanx <- mean(fam_tab$diff)



ggplot(fam_tab %>% filter(diff>=0), aes(diff))+
  geom_density(size = .7, color = 'black')+
  labs(subtitle = "Years to second member entry", x = "Years")+
  #xlim(0,45)
  #ylim(.0,.15)+
  geom_vline(xintercept = medx, color = "red")+
  geom_vline(xintercept = meanx, color = "blue")+
    geom_text(aes(x=(medx-.7), label="Median", y=0.01), colour="red", size =4, angle = 90) +
  geom_text(aes(x=(meanx +.7), label="Mean", y = 0.01), colour="blue", size = 4, angle = 90)+
 theme_minimal()+
  theme(
        plot.background = element_blank(),
        plot.subtitle = element_text(
                                  margin = margin(t = 0, r = 0, b = 20, l = 0)),
        panel.grid.major.x = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line.x = element_line(),
        axis.ticks.y = element_line()
        )

# dyn_ae_ge_fam %>% select(year, dyn_cum_2, relative_id) %>% group_by(family_id, year) %>% summarise(val = sum(dyn_cum_2)/n())
```




<!-- ### relative -->
<!-- ```{r} -->
<!-- dyn <- read.csv("D:/cpr/UP/up-dynasties/dyn_other_data/dyn_family.csv") -->

<!-- dyn_ae_ge <- dyn %>% filter(election_type %in% c("AE", "GE")) -->



<!-- dyn_ae_ge_fam %>% group_by(family_id) %>% filter( dyn_cum_2==1 ) %>% slice(which.min(year))%>% select(year, family_id,dyn_cum_2, relative_id) %>% filter(relative_id==1) -->

<!--  %>%pivot_wider(values_from = year, names_from= dyn_cum_2)  -->



<!-- dyn_ae_ge_fam %>% filter(dyn_cum_2==1) %>% distinct(family_id, .keep_all = TRUE)%>% group_by(level) %>% summarise(count = n()) -->

<!-- ``` -->


---

## Viz {.tabset}

### Life span wrt caste


```{r}
ylim1 = boxplot.stats(dyn_ae_ge_fam_uniq$life_span)$stats[c(1, 5)]



ggplot(dyn_ae_ge_fam_uniq %>% filter(caste_groups!= "Others"),aes(x = reorder(as.factor(caste_groups),-life_span, median), life_span)) +
  geom_boxplot(outlier.shape = NA)+
 # scale_x_discrete(labels=(c("Non - Family", "Family")))+
  coord_cartesian(ylim = ylim1*1.05)+
  theme_minimal()+
  labs(title = "Family life span wrt caste groups ",x = "", y = "Life span \n (in years)") +
  
  theme(plot.margin = unit(c(.5,.5,.5,.5), "cm"),
        plot.background = element_blank(),
        plot.title = element_text(family = "serif",hjust = 0.5, size = 20, 
                                  margin= margin(0,0,20,0)), 
        text = element_text(color = "gray20", family = "serif"),
        legend.title = element_blank(),
        legend.text = element_text(size = 15),
        axis.text = element_text(face = "italic", size = 13),
        axis.title = element_text(vjust = -1, size = 16),        
        axis.ticks = element_blank()
  ) 


```




### caste composition of elite categories

```{r}
# dyn_lb  <- dyn_lb %>% mutate(level_log = ifelse(level == "LB",FALSE,TRUE))
# 
# dyn_lb_uniq <- dyn_lb %>% arrange (-year) %>%  distinct(family_id, .keep_all = TRUE)
# 
# count_tot  <-  dim(dyn_lb_uniq %>% filter(dyn_tot ==1))[1]
# dyn_lb_uniq %>% filter(dyn_tot ==1) %>% group_by(level_log) %>% summarise(prop = n()/count_tot) %>% kable(caption = "Family linkages", col.names = c("Connection", "Proportion"), digits = 2) %>% kable_styling(bootstrap_options = "striped")


dyn_ae_ge_fam_uniq$caste_groups <- factor(dyn_ae_ge_fam_uniq$caste_groups, levels = c("Upper Caste","Yadav","Non-Yadav OBC","Dalit" , "Muslim"  ,"Others" ))



dyn_ae_ge_fam_uniq %>% filter(caste_groups!= "NA") %>% group_by(success_cat, caste_groups) %>% summarise( count = n()) %>% group_by(success_cat) %>% mutate(sum = sum(count), prop = count/sum) %>% select(success_cat, caste_groups, prop) %>% 
  ggplot(aes(factor(success_cat), prop, fill = caste_groups,label = round(prop,2)))+
   geom_bar(stat="identity", position = "stack")+
    geom_text(size = 2.5, position = position_stack(vjust = 0.5))+ 
  colorspace::scale_fill_discrete_qualitative(palette= "dark3" )+
  coord_fixed(ratio =5)+
    theme_minimal()+
      
    labs(title = "Caste composition among families wrt success  ",x = "", y = "Proportion", fill = "") +
    theme(plot.margin = unit(c(.5,.5,.5,.5), "cm"))+
  theme(plot.background = element_blank(),
        axis.line.x = element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.y = element_blank()
  ) 
```




### Ownership of edu categories wrt elite categories


```{r}
dyn_ae_ge_fam_uniq$edu <- as.numeric(paste(dyn_ae_ge_fam_uniq$school, dyn_ae_ge_fam_uniq$college, sep = ""))


# dyn_lb_uniq <- dyn_lb %>% arrange (-year) %>%  distinct(family_id, .keep_all = TRUE)


edu_tab <- dyn_ae_ge_fam_uniq %>%  filter(!is.na(edu)) %>% group_by(success_cat,edu) %>% summarise(count = n())  %>% group_by(success_cat) %>% mutate(sum = sum(count),prop= count/sum) %>% filter(edu!= 0) %>%  arrange(edu, -prop) 

#edu_tab$id=rep(c(1:3),3)

edu_tab$success_cat <- factor(edu_tab$success_cat , levels = c("Stable","Rising", "Declining"))


ggplot(edu_tab , aes(x= reorder(as.factor(edu),-prop), prop )) +   
  geom_bar(aes(fill = as.factor(success_cat)), position = "dodge", stat="identity")+
  theme_minimal()+
  scale_x_discrete(labels=(c( "School" ,"College","Both")))+
  #scale_fill_manual (labels = c("Stable", "Rising", "Declining"))+
  labs(title = "Ownership of educational institutions wrt success", 
       x = "", y = "Proportion") +
  theme(legend.position = "top",plot.title = element_text(hjust = 0.5))+
  theme(plot.margin = unit(c(.5,.5,.5,.5), "cm"),
        plot.title = element_text(hjust = 0.5, size = 18, family = "serif", 
                                  margin = margin(t = 0, r = 0, b = 20, l = 0)), 
        text = element_text(color = "gray20",family = "serif"),
        legend.title = element_blank(),
        legend.text = element_text(size = 12),
        axis.text = element_text(face = "italic", size = 14),
        axis.title.x = element_text(vjust = -1, size = 16),
        axis.title.y = element_text(vjust = 2, size =16),
        axis.ticks.y = element_blank(),
        axis.line= element_line(color = "gray40", size = .5),
        axis.line.y = element_blank(),
        panel.grid.major = element_line(color = "gray50", size = .5),
        panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank()
          
  ) 

```

### Land wrt elite cat.

```{r}
dyn_ae_ge_fam_uniq$land <- as.numeric(dyn_ae_ge_fam_uniq$land)

ggplot(dyn_ae_ge_fam_uniq, aes(success_cat,land))+
  geom_boxplot()+
    geom_boxplot(outlier.shape = NA)+
  ylim(0,1000)+
  theme_minimal()


```



---
## variable sumamry

```{r}

dyn_ae_ge_fam_uniq$minister_dur <- dyn_ae_ge_fam_uniq$minister_dur %>% replace_na(0)

dyn_ae_ge_fam_uniq$land <- as.numeric(dyn_ae_ge_fam_uniq$land)

dyn_ae_ge_fam_uniq$school <- as.numeric(dyn_ae_ge_fam_uniq$school)%>% replace_na(0)

dyn_ae_ge_fam_uniq$college<- as.numeric(dyn_ae_ge_fam_uniq$college)%>% replace_na(0)

dyn_ae_ge_fam_uniq$n_sc_minster <- dyn_ae_ge_fam_uniq$n_sc_minster%>% replace_na(0)

dyn_ae_ge_fam_uniq %>% group_by(success_cat) %>% summarise(mean(land, na.rm = TRUE),mean(indus_count),mean(n_sc_minster), mean(minister_dur), mean(school), mean(college)) %>% kable(col.names = c("Success","land", "industires", "N_minister", "Minister duration (months)", "school", "college"), digits = 2) %>% kable_styling(bootstrap_options = "striped")

#dyn_ae_ge_fam_uniq %>% filter(success_diff_cat == "Stable") 
```


---


## Regressions {.tabset}


This is a multinomial logit model that regresses three success categories. Rising families are the refrence ones. Results do not have any constituency variable here since this is regressed at family level.


```{r, results= "asis"}

library(lfe)
#library(nnet)

#success <- dyn_ae_ge_fam_uniq$success_diff_cat

# fam_tab <- fam_tab %>% mutate(`0` = ifelse(is.na(`0`), `1`,`0`), diff = `1`-`0`)
# 
# dyn_ae_ge_fam_uniq <- inner_join(fam_tab,dyn_ae_ge_fam_uniq, by = "family_id")


second_mem_dur <- dyn_ae_ge_fam_uniq$diff

industry <- dyn_ae_ge_fam_uniq$indus_count %>% replace_na(0)

# industry_rent_thick <- dyn_ae_ge_fam_uniq$indus_rt %>% replace_na(0)
# 
# industry_non_rent_thick <- dyn_ae_ge_fam_uniq$indus_nrt %>% replace_na(0)

caste_uc <- ifelse(dyn_ae_ge_fam_uniq$caste_groups == "Upper Caste", 1,0)


caste_yadav <- ifelse(dyn_ae_ge_fam_uniq$caste_groups == "Yadav", 1,0)

caste_muslim <- ifelse(dyn_ae_ge_fam_uniq$caste_groups == "Muslim", 1,0)

caste_dalit <- ifelse(dyn_ae_ge_fam_uniq$caste_groups == "Dalit", 1,0)

caste_non_yadav_obc <- ifelse(dyn_ae_ge_fam_uniq$caste_groups == "Non-Yadav OBC", 1,0)


turncoat <- dyn_ae_ge_fam_uniq$turncoat


N_minister <- dyn_ae_ge_fam_uniq$n_sc_minster%>% replace_na(0)

minister_duration <- dyn_ae_ge_fam_uniq$min_dur_yr %>% replace_na(0)


minister <-ifelse(dyn_ae_ge_fam_uniq$min_dur_yr>0,1,0)%>% replace_na(0) 


post_2002 <- ifelse(dyn_ae_ge_fam_uniq$year >=2002,1,0)



#n_elections_w<- as.numeric(dyn_ae_ge_fam_uniq$n_el_w)

school <- dyn_ae_ge_fam_uniq$school%>% replace_na(0)

college <- dyn_ae_ge_fam_uniq$college%>% replace_na(0)

school_college <- paste(school, college, sep = "")

school_college <- case_when(school_college == "00"~ 0,
                            TRUE ~ 1)

land <- as.numeric(dyn_ae_ge_fam_uniq$land) %>% replace_na(0)



linkage <- ifelse(dyn_ae_ge_fam_uniq$level %in% c("AE", "GE"),0,1)

linkage_up <- ifelse(dyn_ae_ge_fam_uniq$level%in% c("GE-AE", "GE-AE-LB"),1,0)

linkage_down <- ifelse(dyn_ae_ge_fam_uniq$level_cum %in% c("AE-LB", "GE-AE-LB", "GE-LB"),1,0)

#ml$prog2 <- relevel(ml$prog, ref = "academic")

# dyn_ae_ge_fam_uniq$success_cat <- as.factor(dyn_ae_ge_fam_uniq$success__cat)

Rising <- ifelse(dyn_ae_ge_fam_uniq$success_cat=="Rising",1,0)

Declining <- ifelse(dyn_ae_ge_fam_uniq$success_cat=="Declining",1,0)

Stable<- ifelse(dyn_ae_ge_fam_uniq$success_cat=="Stable",1,0)

success_cat <- dyn_ae_ge_fam_uniq$success_cat


#success_rate <- dyn_ae_ge_fam_uniq$success_diff
```


### 2nd member


```{r results="asis"}


library(lfe)

fit.mem <- felm(second_mem_dur ~caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down )



stargazer(fit.mem, type="html", title = "What determines the years needed for the entry of the second member of a family",keep = c("second_mem_dur","minister_duration","industry", "school_college", "land", "linkage_down"), add.lines = list (c("Caste control", "Yes")))

# stargazer(fit.felm,title="Regression Results - UP  Night lights - Dynast 2 ",type = "text",
# align=TRUE,  no.space=TRUE,add.lines=list(c('Year fixed effects', 'Yes' ), c('District fixed effects', 'Yes'), c("SE clustering" ,"District level")))
# 
# stargazer(fit.linear, fit.logit, fit.poisson,fit.probit,title="Regression Results - UP private colleges - Dynast 2 ",type = "html",
# align=TRUE,  no.space=TRUE, keep = c("dyn_cum_2" ,          "caste_uc", "caste_yadav"   ,      "caste_non_yadav_obc" ,"caste_dalit"   ,"caste_muslim" ),omit.stat=c("LL","ser","f"),add.lines=list(c('Year fixed effects', 'Yes','Yes','Yes','Yes' )))

```


### Multinom {.tabset}

#### With second mem. {.tabset}

##### Multinom. ref. - Rising


```{r message = FALSE, warning = FALSE, echo = FALSE}


success_cat<-factor( success_cat,levels = c( "Rising","Stable","Declining"))

library("nnet")

fit.multinom <- multinom(success_cat~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur)



```


```{r, results= "asis"}
stargazer(fit.multinom, type="html", keep = c("success_cat","minister_duration","industry", "school_college", "land", "linkage_down","second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes","Yes")))
```


##### Multinom. ref. - Stable


```{r message = FALSE, warning = FALSE, echo = FALSE}


success_cat<-factor( success_cat,levels = c( "Stable","Rising","Declining"))

library("nnet")

fit.multinom <- multinom(success_cat~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+ second_mem_dur)
```

```{r, results= "asis"}
stargazer(fit.multinom, type="html", keep = c("success_cat","minister_duration","industry", "school_college", "land", "linkage_down","second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes","Yes")))
```


#### Without second mem. {.tabset}

##### Multinom. ref. - Rising


```{r message = FALSE, warning = FALSE, echo = FALSE}


success_cat<-factor( success_cat,levels = c( "Rising","Stable","Declining"))

library("nnet")

fit.multinom <- multinom(success_cat~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down)



```


```{r, results= "asis"}
stargazer(fit.multinom, type="html", keep = c("success_cat","minister_duration","industry", "school_college", "land", "linkage_down","second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes","Yes")))
```


##### Multinom. ref. - Stable


```{r message = FALSE, warning = FALSE, echo = FALSE}


success_cat<-factor( success_cat,levels = c( "Stable","Rising","Declining"))



fit.multinom <- multinom(success_cat~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down)
```

```{r, results= "asis"}
stargazer(fit.multinom, type="html", keep = c("success_cat","minister_duration","industry", "school_college", "land", "linkage_down","second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes","Yes")))
```

---


### probit


```{r, results="asis"}

fit.1 <- glm(Declining ~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down + second_mem_dur, family= binomial(link = "probit") )


fit.2 <- glm(Rising ~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down + second_mem_dur, family= binomial(link = "probit") )

fit.3 <- glm(Stable ~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+ second_mem_dur, family= binomial(link = "probit") )


 stargazer(fit.1,fit.2,fit.3,title="Regression Results - Success of dynasties ",type = "html",
            align=TRUE,  no.space=TRUE,keep = c("minister_duration","industry", "school_college", "land", "linkage_down","second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes","Yes")))

```


### Dual option {.tabset}

#### stable v/s declining



```{r results="asis"}



## stable v/s declning


sd <- dyn_ae_ge_fam_uniq %>% filter(success_cat!= "Rising")


second_mem_dur <- sd$diff

industry <- sd$indus_count %>% replace_na(0)

# industry_rent_thick <- sd$indus_rt %>% replace_na(0)
# 
# industry_non_rent_thick <- sd$indus_nrt %>% replace_na(0)

caste_uc <- ifelse(sd$caste_groups == "Upper Caste", 1,0)


caste_yadav <- ifelse(sd$caste_groups == "Yadav", 1,0)

caste_muslim <- ifelse(sd$caste_groups == "Muslim", 1,0)

caste_dalit <- ifelse(sd$caste_groups == "Dalit", 1,0)

caste_non_yadav_obc <- ifelse(sd$caste_groups == "Non-Yadav OBC", 1,0)


turncoat <- sd$turncoat


N_minister <- sd$n_sc_minster%>% replace_na(0)

minister_duration <- sd$min_dur_yr %>% replace_na(0)


minister <-ifelse(sd$min_dur_yr>0,1,0)%>% replace_na(0) 


post_2002 <- ifelse(sd$year >=2002,1,0)



#n_elections_w<- as.numeric(sd$n_el_w)

school <- sd$school%>% replace_na(0)

college <- sd$college%>% replace_na(0)

school_college <- paste(school, college, sep = "")

school_college <- case_when(school_college == "00"~ 0,
                            TRUE ~ 1)

land <- as.numeric(sd$land) %>% replace_na(0)



linkage <- ifelse(sd$level %in% c("AE", "GE"),0,1)

linkage_up <- ifelse(sd$level%in% c("GE-AE", "GE-AE-LB"),1,0)

linkage_down <- ifelse(sd$level_cum %in% c("AE-LB", "GE-AE-LB", "GE-LB"),1,0)





#success_cat <- relevel(success_cat, ref = "stable")


Declining <- ifelse(sd$success_cat=="Declining",1,0)

fit.1 <- glm(Declining~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

#summary(fit.1)
# 



Stable <- ifelse(sd$success_cat=="Stable",1,0)

fit.2 <- glm(Stable~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

#summary(fit.2)


 stargazer(fit.1,fit.2,title="Regression Results - Declining v/s Stable ",type = "html",
            align=TRUE,  no.space=TRUE,keep = c("minister_duration","industry", "school_college", "land", "linkage_down", "second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes")))

```


#### Stable v/s rising




```{r results = "asis"}
## stable v/s rising

sd <- dyn_ae_ge_fam_uniq %>% filter(success_cat!= "Declining")


second_mem_dur <- sd$diff

industry <- sd$indus_count %>% replace_na(0)

# industry_rent_thick <- sd$indus_rt %>% replace_na(0)
# 
# industry_non_rent_thick <- sd$indus_nrt %>% replace_na(0)

caste_uc <- ifelse(sd$caste_groups == "Upper Caste", 1,0)


caste_yadav <- ifelse(sd$caste_groups == "Yadav", 1,0)

caste_muslim <- ifelse(sd$caste_groups == "Muslim", 1,0)

caste_dalit <- ifelse(sd$caste_groups == "Dalit", 1,0)

caste_non_yadav_obc <- ifelse(sd$caste_groups == "Non-Yadav OBC", 1,0)


turncoat <- sd$turncoat


N_minister <- sd$n_sc_minster%>% replace_na(0)

minister_duration <- sd$min_dur_yr %>% replace_na(0)


minister <-ifelse(sd$min_dur_yr>0,1,0)%>% replace_na(0) 


post_2002 <- ifelse(sd$year >=2002,1,0)



#n_elections_w<- as.numeric(sd$n_el_w)

school <- sd$school%>% replace_na(0)

college <- sd$college%>% replace_na(0)

school_college <- paste(school, college, sep = "")

school_college <- case_when(school_college == "00"~ 0,
                            TRUE ~ 1)

land <- as.numeric(sd$land) %>% replace_na(0)



linkage <- ifelse(sd$level %in% c("AE", "GE"),0,1)

linkage_up <- ifelse(sd$level%in% c("GE-AE", "GE-AE-LB"),1,0)

linkage_down <- ifelse(sd$level_cum %in% c("AE-LB", "GE-AE-LB", "GE-LB"),1,0)





#success_cat <- relevel(success_cat, ref = "stable")


Stable<- ifelse(sd$success_cat=="Stable",1,0)

fit.1 <- glm(Stable~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

#summary(fit.1)


Rising<- ifelse(sd$success_cat=="Rising",1,0)

fit.2 <- glm(Rising ~ caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

#summary(fit.2)


 stargazer(fit.1,fit.2,title="Regression Results - Stable v/s Rising ",type = "html",
            align=TRUE,  no.space=TRUE,keep = c("minister_duration","industry", "school_college", "land", "linkage_down", "second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes")))

```

#### Rising v/s declining

```{r results="asis"}
## rising v/s declning


sd <- dyn_ae_ge_fam_uniq %>% filter(success_cat!= "Declining")


second_mem_dur <- sd$diff

industry <- sd$indus_count %>% replace_na(0)

# industry_rent_thick <- sd$indus_rt %>% replace_na(0)
# 
# industry_non_rent_thick <- sd$indus_nrt %>% replace_na(0)

caste_uc <- ifelse(sd$caste_groups == "Upper Caste", 1,0)


caste_yadav <- ifelse(sd$caste_groups == "Yadav", 1,0)

caste_muslim <- ifelse(sd$caste_groups == "Muslim", 1,0)

caste_dalit <- ifelse(sd$caste_groups == "Dalit", 1,0)

caste_non_yadav_obc <- ifelse(sd$caste_groups == "Non-Yadav OBC", 1,0)


turncoat <- sd$turncoat


N_minister <- sd$n_sc_minster%>% replace_na(0)

minister_duration <- sd$min_dur_yr %>% replace_na(0)


minister <-ifelse(sd$min_dur_yr>0,1,0)%>% replace_na(0) 


post_2002 <- ifelse(sd$year >=2002,1,0)



#n_elections_w<- as.numeric(sd$n_el_w)

school <- sd$school%>% replace_na(0)

college <- sd$college%>% replace_na(0)

school_college <- paste(school, college, sep = "")

school_college <- case_when(school_college == "00"~ 0,
                            TRUE ~ 1)

land <- as.numeric(sd$land) %>% replace_na(0)



linkage <- ifelse(sd$level %in% c("AE", "GE"),0,1)

linkage_up <- ifelse(sd$level%in% c("GE-AE", "GE-AE-LB"),1,0)

linkage_down <- ifelse(sd$level_cum %in% c("AE-LB", "GE-AE-LB", "GE-LB"),1,0)





#success_cat <- relevel(success_cat, ref = "stable")


Declining <- ifelse(sd$success_cat=="Declining",1,0)

fit.1 <- glm(Declining~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

##summary(fit.1)

Rising<- ifelse(sd$success_cat=="Rising",1,0)

fit.2 <- glm(Rising~  caste_uc+ caste_yadav+caste_non_yadav_obc + caste_dalit + caste_muslim +minister_duration +industry + school_college + land + linkage_down+second_mem_dur, family= binomial(link = "probit") )

##summary(fit.1)

 stargazer(fit.1,fit.2,title="Regression Results - Declining v/s Rising ",type = "html",
            align=TRUE,  no.space=TRUE,keep = c("minister_duration","industry", "school_college", "land", "linkage_down", "second_mem_dur"),add.lines = list (c("Caste control", "Yes","Yes")))

```


